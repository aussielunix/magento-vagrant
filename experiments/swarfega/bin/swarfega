#!/usr/bin/env ruby

require 'methadone'
require 'swarfega'

module Swarfega

  include Methadone::Main
  include Methadone::CLILogging
  include Methadone::ExitNow

  main do |platform|
    debug(options.inspect)
    ::Swarfega::Test.new(platform.to_s.strip, options).run
  end

  version Swarfega::VERSION
  description 'platform tests'

  arg         :platform, :required

  on('--url http://example.com/admin', 'url to test')
  on('--output [nagios|report]', 'output in a nagios plugin or general report format', '(Default: nagios)')

  # default to nagios plugin format
  options[:output] = 'nagios'

  use_log_level_option

  go!
end
